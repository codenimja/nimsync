# Nim configuration for nimsync - optimized for performance

# Default compilation settings
--path:"src"

# Memory management - use ORC for best balance of performance and safety
--mm:orc
--threads:on

# Enable useful warnings and hints
--warning[UnusedImport]:off
--hint[Processing]:off
--hint[Conf]:off

# Release optimizations (can be overridden with -d:debug)
--opt:speed

@if release or danger:
  --stackTrace:off
  --lineTrace:off
  --assertions:off
  --debugger:off
  --debuginfo:off
@end

@if danger:
  --checks:off
  --boundChecks:off
  --overflowChecks:off
  --nilChecks:off
  --rangeChecks:off
@end

# Link-time optimization when available
@if lto:
  --passC:"-flto"
  --passL:"-flto"
@end

# Experimental features for advanced optimization
# Temporarily disabled due to compatibility issues
# --experimental:views
# --experimental:strictFuncs

# Threading optimizations
@if threads:
  --threadAnalysis:off
@end

# Performance-focused C compiler flags for GCC
@if gcc and release:
  --passC:"-O3"
  --passC:"-fno-strict-aliasing"
@end

@if gcc and danger:
  --passC:"-O3"
  --passC:"-ffast-math"
  --passC:"-fno-strict-aliasing"
  --passC:"-DNDEBUG"
@end

# Performance-focused C compiler flags for Clang
@if clang and release:
  --passC:"-O3"
  --passC:"-fno-strict-aliasing"
@end

@if clang and danger:
  --passC:"-O3"
  --passC:"-ffast-math"
  --passC:"-fno-strict-aliasing"
  --passC:"-DNDEBUG"
@end

# Performance-focused C compiler flags for MSVC
@if vcc and release:
  --passC:"/O2"
@end

@if vcc and danger:
  --passC:"/O2"
  --passC:"/DNDEBUG"
@end

# Development settings (default when not release/danger)
@if not (release or danger):
  --hints:on
  --warnings:on
  --debuginfo:on
  --stackTrace:on
  --lineTrace:on
@end